<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Futures Calculator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background-color: #ffffff;
    color: #000000;
    transition: background-color 0.3s, color 0.3s;
  }
  .dark-mode {
    background-color: #121212;
    color: #f0f0f0;
  }
  .container {
    max-width: 600px;
    margin: 20px auto;
  }
  .form-group {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
  }
  .form-group label {
    flex: 1;
  }
  .form-group input, .form-group select {
    flex: 2;
  }
  button {
    padding: 8px 12px;
    cursor: pointer;
  }
  .results {
    margin-top: 20px;
  }
  .toggle-mode {
    float: right;
    margin-bottom: 20px;
  }
</style>
</head>
<body>
<div class="container">
  <button class="toggle-mode" onclick="toggleMode()">Toggle Dark/Light</button>
  <h2>Futures PnL + Liquidation Calculator</h2>
  <div class="form-group">
    <label for="position">Position Type</label>
    <select id="position">
      <option value="Long">Long</option>
      <option value="Short">Short</option>
    </select>
  </div>
  <div class="form-group">
    <label for="margin">Margin (USDT)</label>
    <input type="number" id="margin" value="10">
  </div>
  <div class="form-group">
    <label for="leverage">Leverage</label>
    <input type="number" id="leverage" value="20">
  </div>
  <div class="form-group">
    <label for="entry">Entry Price</label>
    <input type="number" id="entry" value="110000">
  </div>
  <div class="form-group">
    <label for="current">Current Price</label>
    <input type="number" id="current" value="110100">
  </div>
  <div class="form-group">
    <label for="stoploss">Stop Loss</label>
    <input type="number" id="stoploss" value="109000">
  </div>
  <div class="form-group">
    <label for="takeprofit">Take Profit</label>
    <input type="number" id="takeprofit" value="112000">
  </div>
  <button onclick="calculate()">Calculate</button>
  <div class="results" id="results">
    <p>Current PnL (USDT): <span id="cPnl">-</span></p>
    <p>ROI %: <span id="roi">-</span></p>
    <p>Stop Loss PnL: <span id="slPnl">-</span></p>
    <p>Take Profit PnL: <span id="tpPnl">-</span></p>
    <p>Liquidation Price: <span id="liq">-</span></p>
  </div>
  <canvas id="pnlChart" width="600" height="300"></canvas>
</div>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
function toggleMode() {
  document.body.classList.toggle('dark-mode');
}
function calculate() {
  let entry = parseFloat(document.getElementById('entry').value);
  let current = parseFloat(document.getElementById('current').value);
  let sl = parseFloat(document.getElementById('stoploss').value);
  let tp = parseFloat(document.getElementById('takeprofit').value);
  let margin = parseFloat(document.getElementById('margin').value);
  let leverage = parseFloat(document.getElementById('leverage').value);

  let pnlCurrent = ((current - entry)/entry) * leverage * margin;
  let pnlSL = ((sl - entry)/entry) * leverage * margin;
  let pnlTP = ((tp - entry)/entry) * leverage * margin;
  let roi = (pnlCurrent / margin) * 100;
  let liq = entry * (1 - (1/leverage));

  document.getElementById('cPnl').innerText = pnlCurrent.toFixed(2);
  document.getElementById('roi').innerText = roi.toFixed(2) + "%";
  document.getElementById('slPnl').innerText = pnlSL.toFixed(2);
  document.getElementById('tpPnl').innerText = pnlTP.toFixed(2);
  document.getElementById('liq').innerText = liq.toFixed(2);

  // Chart
  const ctx = document.getElementById('pnlChart').getContext('2d');
  if(window.myChart) window.myChart.destroy();
  window.myChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: ["Entry", "StopLoss", "Current", "TakeProfit", "Liquidation"],
      datasets: [{
        label: 'Price Levels',
        data: [entry, sl, current, tp, liq],
        borderColor: 'blue',
        fill: false,
        pointBackgroundColor:["blue","red","green","orange","black"],
        pointRadius:6
      }]
    },
    options:{responsive:true,plugins:{legend:{display:false}}}
  });
}
</script>
</body>
</html>
